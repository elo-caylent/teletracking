{
  "version": 4,
  "terraform_version": "1.4.5",
  "serial": 3448,
  "lineage": "9aac1bc0-0836-1f13-0a18-5df3f22406a3",
  "outputs": {},
  "resources": [
    {
      "module": "module.network_firewall",
      "mode": "managed",
      "type": "aws_networkfirewall_firewall",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:network-firewall:ap-northeast-1:931366402038:firewall/Hub-nfw-fw-hub",
            "delete_protection": false,
            "description": "fw-hub",
            "encryption_configuration": [],
            "firewall_policy_arn": "arn:aws:network-firewall:ap-northeast-1:931366402038:firewall-policy/Hub-nfw-policy-fw-hub",
            "firewall_policy_change_protection": false,
            "firewall_status": [
              {
                "sync_states": [
                  {
                    "attachment": [
                      {
                        "endpoint_id": "vpce-05cb203d461cb5984",
                        "subnet_id": "subnet-0ebf9ed6bb7844318"
                      }
                    ],
                    "availability_zone": "ap-northeast-1a"
                  },
                  {
                    "attachment": [
                      {
                        "endpoint_id": "vpce-064a48eaa2397c1a6",
                        "subnet_id": "subnet-0be4f3c2c4a33a8b1"
                      }
                    ],
                    "availability_zone": "ap-northeast-1d"
                  },
                  {
                    "attachment": [
                      {
                        "endpoint_id": "vpce-066bc376c6f03c06f",
                        "subnet_id": "subnet-0bc8463c94522414f"
                      }
                    ],
                    "availability_zone": "ap-northeast-1c"
                  }
                ]
              }
            ],
            "id": "arn:aws:network-firewall:ap-northeast-1:931366402038:firewall/Hub-nfw-fw-hub",
            "name": "Hub-nfw-fw-hub",
            "subnet_change_protection": false,
            "subnet_mapping": [
              {
                "ip_address_type": "IPV4",
                "subnet_id": "subnet-0bc8463c94522414f"
              },
              {
                "ip_address_type": "IPV4",
                "subnet_id": "subnet-0be4f3c2c4a33a8b1"
              },
              {
                "ip_address_type": "IPV4",
                "subnet_id": "subnet-0ebf9ed6bb7844318"
              }
            ],
            "tags": {
              "Name": "mse-poc-vpc",
              "costcenter": "mse-poc",
              "dataclassification": "mse-poc",
              "environment": "mse-poc",
              "map-migrated": "mig44451",
              "serviceline": "mse-poc",
              "space": "mse-poc"
            },
            "tags_all": {
              "Name": "mse-poc-vpc",
              "costcenter": "mse-poc",
              "dataclassification": "mse-poc",
              "environment": "mse-poc",
              "map-migrated": "mig44451",
              "serviceline": "mse-poc",
              "space": "mse-poc"
            },
            "update_token": "710fb91b-c1a3-4b49-bd6d-5bcab7328dc1",
            "vpc_id": "vpc-0dfe14c60ad6b89cd"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.network_firewall.aws_networkfirewall_firewall_policy.this",
            "module.network_firewall.aws_networkfirewall_rule_group.domain_stateful_group",
            "module.network_firewall.aws_networkfirewall_rule_group.fivetuple_stateful_group",
            "module.network_firewall.aws_networkfirewall_rule_group.stateless_group",
            "module.network_firewall.aws_networkfirewall_rule_group.suricata_stateful_group",
            "module.vpc.aws_subnet.public",
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_vpc_ipv4_cidr_block_association.this"
          ]
        }
      ]
    },
    {
      "module": "module.network_firewall",
      "mode": "managed",
      "type": "aws_networkfirewall_firewall_policy",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:network-firewall:ap-northeast-1:931366402038:firewall-policy/Hub-nfw-policy-fw-hub",
            "description": "",
            "encryption_configuration": [],
            "firewall_policy": [
              {
                "stateful_default_actions": [],
                "stateful_engine_options": [],
                "stateful_rule_group_reference": [
                  {
                    "override": [],
                    "priority": 0,
                    "resource_arn": "arn:aws:network-firewall:ap-northeast-1:931366402038:stateful-rulegroup/stateful-rule-set"
                  }
                ],
                "stateless_custom_action": [],
                "stateless_default_actions": [
                  "aws:forward_to_sfe"
                ],
                "stateless_fragment_default_actions": [
                  "aws:forward_to_sfe"
                ],
                "stateless_rule_group_reference": [
                  {
                    "priority": 1,
                    "resource_arn": "arn:aws:network-firewall:ap-northeast-1:931366402038:stateless-rulegroup/stateless"
                  }
                ]
              }
            ],
            "id": "arn:aws:network-firewall:ap-northeast-1:931366402038:firewall-policy/Hub-nfw-policy-fw-hub",
            "name": "Hub-nfw-policy-fw-hub",
            "tags": {
              "Name": "mse-poc-vpc",
              "costcenter": "mse-poc",
              "dataclassification": "mse-poc",
              "environment": "mse-poc",
              "map-migrated": "mig44451",
              "serviceline": "mse-poc",
              "space": "mse-poc"
            },
            "tags_all": {
              "Name": "mse-poc-vpc",
              "costcenter": "mse-poc",
              "dataclassification": "mse-poc",
              "environment": "mse-poc",
              "map-migrated": "mig44451",
              "serviceline": "mse-poc",
              "space": "mse-poc"
            },
            "update_token": "7c1b1bae-bcf2-4ac1-a54f-f9b250ebfa90"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.network_firewall.aws_networkfirewall_rule_group.domain_stateful_group",
            "module.network_firewall.aws_networkfirewall_rule_group.fivetuple_stateful_group",
            "module.network_firewall.aws_networkfirewall_rule_group.stateless_group",
            "module.network_firewall.aws_networkfirewall_rule_group.suricata_stateful_group"
          ]
        }
      ]
    },
    {
      "module": "module.network_firewall",
      "mode": "managed",
      "type": "aws_networkfirewall_rule_group",
      "name": "fivetuple_stateful_group",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:network-firewall:ap-northeast-1:931366402038:stateful-rulegroup/stateful-rule-set",
            "capacity": 100,
            "description": "5 tuple Stateful rule set for MSE PoC",
            "encryption_configuration": [],
            "id": "arn:aws:network-firewall:ap-northeast-1:931366402038:stateful-rulegroup/stateful-rule-set",
            "name": "stateful-rule-set",
            "rule_group": [
              {
                "reference_sets": [],
                "rule_variables": [
                  {
                    "ip_sets": [
                      {
                        "ip_set": [
                          {
                            "definition": [
                              "10.1.128.0/20",
                              "10.1.160.0/21"
                            ]
                          }
                        ],
                        "key": "HOME_NET"
                      }
                    ],
                    "port_sets": [
                      {
                        "key": "SIP_PORTS",
                        "port_set": [
                          {
                            "definition": [
                              "49100",
                              "49101",
                              "49102",
                              "49103",
                              "49104",
                              "49105",
                              "49106",
                              "49107",
                              "49108",
                              "49109",
                              "49110",
                              "49111",
                              "49112",
                              "49113",
                              "49114",
                              "49115",
                              "49116",
                              "49117",
                              "49118",
                              "49119",
                              "49120",
                              "49121",
                              "49122",
                              "49123",
                              "49124",
                              "49125",
                              "49126",
                              "49127",
                              "49128",
                              "49129",
                              "5060"
                            ]
                          }
                        ]
                      },
                      {
                        "key": "WEB_PORTS",
                        "port_set": [
                          {
                            "definition": [
                              "443",
                              "80"
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ],
                "rules_source": [
                  {
                    "rules_source_list": [],
                    "rules_string": "",
                    "stateful_rule": [
                      {
                        "action": "PASS",
                        "header": [
                          {
                            "destination": "10.1.129.0/24",
                            "destination_port": "$SIP_PORTS",
                            "direction": "FORWARD",
                            "protocol": "TCP",
                            "source": "0.0.0.0/0",
                            "source_port": "ANY"
                          }
                        ],
                        "rule_option": [
                          {
                            "keyword": "sid",
                            "settings": [
                              "1; msg:\"Pass All Rule\""
                            ]
                          }
                        ]
                      },
                      {
                        "action": "PASS",
                        "header": [
                          {
                            "destination": "0.0.0.0/0",
                            "destination_port": "$WEB_PORTS",
                            "direction": "FORWARD",
                            "protocol": "HTTP",
                            "source": "$HOME_NET",
                            "source_port": "ANY"
                          }
                        ],
                        "rule_option": [
                          {
                            "keyword": "sid",
                            "settings": [
                              "2; msg:\"Pass All Rule\""
                            ]
                          }
                        ]
                      },
                      {
                        "action": "PASS",
                        "header": [
                          {
                            "destination": "0.0.0.0/0",
                            "destination_port": "5671",
                            "direction": "FORWARD",
                            "protocol": "TCP",
                            "source": "10.1.160.128/26",
                            "source_port": "ANY"
                          }
                        ],
                        "rule_option": [
                          {
                            "keyword": "sid",
                            "settings": [
                              "3; msg:\"Pass All Rule\""
                            ]
                          }
                        ]
                      },
                      {
                        "action": "PASS",
                        "header": [
                          {
                            "destination": "10.1.129.0/24",
                            "destination_port": "5671",
                            "direction": "FORWARD",
                            "protocol": "TCP",
                            "source": "0.0.0.0/0",
                            "source_port": "ANY"
                          }
                        ],
                        "rule_option": [
                          {
                            "keyword": "sid",
                            "settings": [
                              "4; msg:\"Pass All Rule\""
                            ]
                          }
                        ]
                      },
                      {
                        "action": "PASS",
                        "header": [
                          {
                            "destination": "10.1.129.0/24",
                            "destination_port": "5671",
                            "direction": "FORWARD",
                            "protocol": "UDP",
                            "source": "0.0.0.0/0",
                            "source_port": "ANY"
                          }
                        ],
                        "rule_option": [
                          {
                            "keyword": "sid",
                            "settings": [
                              "5; msg:\"Pass All Rule\""
                            ]
                          }
                        ]
                      },
                      {
                        "action": "PASS",
                        "header": [
                          {
                            "destination": "0.0.0.0/0",
                            "destination_port": "5671",
                            "direction": "FORWARD",
                            "protocol": "TCP",
                            "source": "10.1.160.0/21",
                            "source_port": "ANY"
                          }
                        ],
                        "rule_option": [
                          {
                            "keyword": "sid",
                            "settings": [
                              "6; msg:\"Pass All Rule\""
                            ]
                          }
                        ]
                      },
                      {
                        "action": "PASS",
                        "header": [
                          {
                            "destination": "0.0.0.0/0",
                            "destination_port": "5671",
                            "direction": "FORWARD",
                            "protocol": "UDP",
                            "source": "10.1.160.0/21",
                            "source_port": "ANY"
                          }
                        ],
                        "rule_option": [
                          {
                            "keyword": "sid",
                            "settings": [
                              "7; msg:\"Pass All Rule\""
                            ]
                          }
                        ]
                      }
                    ],
                    "stateless_rules_and_custom_actions": []
                  }
                ],
                "stateful_rule_options": []
              }
            ],
            "rules": null,
            "tags": {
              "Name": "mse-poc-vpc",
              "costcenter": "mse-poc",
              "dataclassification": "mse-poc",
              "environment": "mse-poc",
              "map-migrated": "mig44451",
              "serviceline": "mse-poc",
              "space": "mse-poc"
            },
            "tags_all": {
              "Name": "mse-poc-vpc",
              "costcenter": "mse-poc",
              "dataclassification": "mse-poc",
              "environment": "mse-poc",
              "map-migrated": "mig44451",
              "serviceline": "mse-poc",
              "space": "mse-poc"
            },
            "type": "STATEFUL",
            "update_token": "ce458bb0-639a-4b24-85d3-0058537c0042"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.network_firewall",
      "mode": "managed",
      "type": "aws_networkfirewall_rule_group",
      "name": "stateless_group",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:network-firewall:ap-northeast-1:931366402038:stateless-rulegroup/stateless",
            "capacity": 100,
            "description": "Stateless rule example1",
            "encryption_configuration": [],
            "id": "arn:aws:network-firewall:ap-northeast-1:931366402038:stateless-rulegroup/stateless",
            "name": "stateless",
            "rule_group": [
              {
                "reference_sets": [],
                "rule_variables": [],
                "rules_source": [
                  {
                    "rules_source_list": [],
                    "rules_string": "",
                    "stateful_rule": [],
                    "stateless_rules_and_custom_actions": [
                      {
                        "custom_action": [],
                        "stateless_rule": [
                          {
                            "priority": 1,
                            "rule_definition": [
                              {
                                "actions": [
                                  "aws:DROP"
                                ],
                                "match_attributes": [
                                  {
                                    "destination": [
                                      {
                                        "address_definition": "0.0.0.0/0"
                                      }
                                    ],
                                    "destination_port": [],
                                    "protocols": [
                                      1
                                    ],
                                    "source": [
                                      {
                                        "address_definition": "0.0.0.0/0"
                                      }
                                    ],
                                    "source_port": [],
                                    "tcp_flag": []
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ],
                "stateful_rule_options": []
              }
            ],
            "rules": null,
            "tags": {
              "Name": "mse-poc-vpc",
              "costcenter": "mse-poc",
              "dataclassification": "mse-poc",
              "environment": "mse-poc",
              "map-migrated": "mig44451",
              "serviceline": "mse-poc",
              "space": "mse-poc"
            },
            "tags_all": {
              "Name": "mse-poc-vpc",
              "costcenter": "mse-poc",
              "dataclassification": "mse-poc",
              "environment": "mse-poc",
              "map-migrated": "mig44451",
              "serviceline": "mse-poc",
              "space": "mse-poc"
            },
            "type": "STATELESS",
            "update_token": "d0c14ce2-7d40-4730-91a8-9767d830888b"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_subnet",
      "name": "public",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:ec2:ap-northeast-1:931366402038:subnet/subnet-0ebf9ed6bb7844318",
            "assign_ipv6_address_on_creation": false,
            "availability_zone": "ap-northeast-1a",
            "availability_zone_id": "apne1-az4",
            "cidr_block": "10.1.128.0/28",
            "customer_owned_ipv4_pool": "",
            "enable_dns64": false,
            "enable_lni_at_device_index": 0,
            "enable_resource_name_dns_a_record_on_launch": false,
            "enable_resource_name_dns_aaaa_record_on_launch": false,
            "id": "subnet-0ebf9ed6bb7844318",
            "ipv6_cidr_block": "",
            "ipv6_cidr_block_association_id": "",
            "ipv6_native": false,
            "map_customer_owned_ip_on_launch": false,
            "map_public_ip_on_launch": false,
            "outpost_arn": "",
            "owner_id": "931366402038",
            "private_dns_hostname_type_on_launch": "ip-name",
            "tags": {
              "Name": "hub-public-ap-northeast-1a"
            },
            "tags_all": {
              "Name": "hub-public-ap-northeast-1a"
            },
            "timeouts": null,
            "vpc_id": "vpc-0dfe14c60ad6b89cd"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_vpc_ipv4_cidr_block_association.this"
          ]
        },
        {
          "index_key": 1,
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:ec2:ap-northeast-1:931366402038:subnet/subnet-0bc8463c94522414f",
            "assign_ipv6_address_on_creation": false,
            "availability_zone": "ap-northeast-1c",
            "availability_zone_id": "apne1-az1",
            "cidr_block": "10.1.128.16/28",
            "customer_owned_ipv4_pool": "",
            "enable_dns64": false,
            "enable_lni_at_device_index": 0,
            "enable_resource_name_dns_a_record_on_launch": false,
            "enable_resource_name_dns_aaaa_record_on_launch": false,
            "id": "subnet-0bc8463c94522414f",
            "ipv6_cidr_block": "",
            "ipv6_cidr_block_association_id": "",
            "ipv6_native": false,
            "map_customer_owned_ip_on_launch": false,
            "map_public_ip_on_launch": false,
            "outpost_arn": "",
            "owner_id": "931366402038",
            "private_dns_hostname_type_on_launch": "ip-name",
            "tags": {
              "Name": "hub-public-ap-northeast-1c"
            },
            "tags_all": {
              "Name": "hub-public-ap-northeast-1c"
            },
            "timeouts": null,
            "vpc_id": "vpc-0dfe14c60ad6b89cd"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_vpc_ipv4_cidr_block_association.this"
          ]
        },
        {
          "index_key": 2,
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:ec2:ap-northeast-1:931366402038:subnet/subnet-0be4f3c2c4a33a8b1",
            "assign_ipv6_address_on_creation": false,
            "availability_zone": "ap-northeast-1d",
            "availability_zone_id": "apne1-az2",
            "cidr_block": "10.1.128.32/28",
            "customer_owned_ipv4_pool": "",
            "enable_dns64": false,
            "enable_lni_at_device_index": 0,
            "enable_resource_name_dns_a_record_on_launch": false,
            "enable_resource_name_dns_aaaa_record_on_launch": false,
            "id": "subnet-0be4f3c2c4a33a8b1",
            "ipv6_cidr_block": "",
            "ipv6_cidr_block_association_id": "",
            "ipv6_native": false,
            "map_customer_owned_ip_on_launch": false,
            "map_public_ip_on_launch": false,
            "outpost_arn": "",
            "owner_id": "931366402038",
            "private_dns_hostname_type_on_launch": "ip-name",
            "tags": {
              "Name": "hub-public-ap-northeast-1d"
            },
            "tags_all": {
              "Name": "hub-public-ap-northeast-1d"
            },
            "timeouts": null,
            "vpc_id": "vpc-0dfe14c60ad6b89cd"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "module.vpc.aws_vpc.this",
            "module.vpc.aws_vpc_ipv4_cidr_block_association.this"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_vpc",
      "name": "this",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:ec2:ap-northeast-1:931366402038:vpc/vpc-0dfe14c60ad6b89cd",
            "assign_generated_ipv6_cidr_block": false,
            "cidr_block": "10.1.128.0/20",
            "default_network_acl_id": "acl-02bae91d71c0a2f6b",
            "default_route_table_id": "rtb-0c56a6d81c34c7ce7",
            "default_security_group_id": "sg-04e0e05569630cabc",
            "dhcp_options_id": "dopt-8f90f8ea",
            "enable_classiclink": false,
            "enable_classiclink_dns_support": false,
            "enable_dns_hostnames": true,
            "enable_dns_support": true,
            "enable_network_address_usage_metrics": false,
            "id": "vpc-0dfe14c60ad6b89cd",
            "instance_tenancy": "default",
            "ipv4_ipam_pool_id": null,
            "ipv4_netmask_length": null,
            "ipv6_association_id": "",
            "ipv6_cidr_block": "",
            "ipv6_cidr_block_network_border_group": "",
            "ipv6_ipam_pool_id": "",
            "ipv6_netmask_length": 0,
            "main_route_table_id": "rtb-0c56a6d81c34c7ce7",
            "owner_id": "931366402038",
            "tags": {
              "Name": "hub"
            },
            "tags_all": {
              "Name": "hub"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    }
  ],
  "check_results": null
}
